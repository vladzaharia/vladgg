---
interface Props {
  entry: {
    position: {
      name: string;
      slug: string;
    };
    positionShort?: string;
    company: {
      name: string;
      nameShort: string | null;
      logo: string | null;
    };
    location: string;
    dates: {
      from: string;
      to: string | null;
    };
  };
  color: {
    border: string;
    text: string;
    shadow: string;
    darkText: string;
  };
  startDate: string;
  endDate: string;
}

const { entry, color, startDate, endDate } = Astro.props;
---

<div class="timeline-card-expanded fixed hidden z-50 inset-0">
  <div class="fixed inset-0 bg-slate-900/80 backdrop-blur-md"></div>
  <div
    class={`
      expanded-content
      bg-slate-800 rounded-lg border overflow-hidden
      transition-transform duration-300 ease-[cubic-bezier(0.4,0,0.2,1)]
      h-[60vh] w-[40vw] relative z-10 ${color.shadow}
      ${color.border}
    `}
  >
    <div
      class="sticky top-0 flex justify-between items-start p-6 bg-slate-800/95 backdrop-blur-sm border-b border-slate-700"
    >
      <div class="flex-1 pr-4">
        <h2 class="text-2xl font-bold mb-1">{entry.position.name}</h2>
        <div class="flex items-center gap-4 text-gray-400">
          <div class="flex items-center gap-2">
            {
              entry.company.logo && (
                <img src={entry.company.logo} alt={entry.company.name} class="h-6 w-auto" />
              )
            }
            <span>{entry.company.name}</span>
          </div>
          <span class="text-gray-600">â€¢</span>
          <span>{entry.location}</span>
        </div>
      </div>
      <button
        class="close-expanded text-gray-400 hover:text-white p-1 hover:bg-white/5 rounded-lg transition-colors"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-6 w-6"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <div class="p-6 space-y-6 overflow-y-auto max-h-[calc(60vh-5rem)]">
      <div class="flex items-center gap-2 text-sm text-gray-400 font-medium">
        <div class={`h-3 w-3 rounded-full ${color.text}`}></div>
        <span>{startDate} - {endDate}</span>
      </div>

      <div
        class="prose prose-invert max-w-none prose-headings:font-display prose-p:text-gray-300 prose-a:text-blue-400"
      >
        <slot name="expanded" />
      </div>
    </div>
  </div>
</div>

<style>
  .timeline-card-expanded {
    opacity: 0;
    transition: opacity 0.3s ease-in-out;
  }

  .timeline-card-expanded.opacity-100 {
    opacity: 1;
  }

  .expanded-content {
    position: fixed;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
  }

  /* Customize scrollbar */
  .overflow-y-auto {
    scrollbar-width: thin;
    scrollbar-color: rgba(255, 255, 255, 0.1) transparent;
  }

  .overflow-y-auto::-webkit-scrollbar {
    width: 6px;
  }

  .overflow-y-auto::-webkit-scrollbar-track {
    background: transparent;
  }

  .overflow-y-auto::-webkit-scrollbar-thumb {
    background-color: rgba(255, 255, 255, 0.1);
    border-radius: 3px;
  }

  .overflow-y-auto::-webkit-scrollbar-thumb:hover {
    background-color: rgba(255, 255, 255, 0.2);
  }
</style>
